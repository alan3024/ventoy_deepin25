# Vtoyboot 只读文件系统修复脚本 
## 问题背景
在某些特定的 Linux 发行版，尤其是 Live 系统或采用"不可变文件系统"（Immutable Filesystem）设计的系统（例如某些版本的 Deepin UOS, Fedora Silverblue 等）上直接运行 `vtoyboot.sh` 脚本时，会遇到大量的 "只读文件系统" (Read-only filesystem) 错误。
这是因为这些系统为了安全性和稳定性，将 `/`, `/usr` 等核心系统目录挂载为只读模式，阻止任何程序（即使是 root）直接修改其中的内容。这导致 `vtoyboot.sh` 无法将 `vtoydump`, `vtoytool` 等工具复制到 `/sbin` 或 `/usr/sbin` 目录，从而安装失败。
## 作用

修复脚本，旨在解决上述问题，使得 `vtoyboot.sh` 能够在这种特殊的只读系统环境下成功运行。
## 工作原理
本脚本采用了 **绑定挂载 (Bind Mount)** 的技术来巧妙地绕过系统限制，其主要步骤如下：
1.  **创建临时空间**：在内存中 (`/tmp`) 创建一个临时的、可读写的目录结构。
2.  **复制内容**：将 `vtoyboot.sh` 需要修改的目标目录（如 `/usr/sbin`, `/usr/share/initramfs-tools/hooks` 等）的原始内容，完整地复制到这个临时空间里。
3.  **绑定挂载 (覆盖)**：使用 `mount --bind` 命令，将我们创建的那个可读写的临时目录，"覆盖"到系统原始的只读目录之上。这个操作只在当前会话中生效，不会永久更改系统。
4.  **执行安装**：此时，当 `vtoyboot.sh` 尝试向 `/usr/sbin` 等目录写入文件时，实际的写入操作被透明地重定向到了我们在内存中创建的可写目录里，因此不会再出现"只读文件系统"的错误。
5.  **自动清理**：脚本通过 `trap` 机制确保，无论 `vtoyboot.sh` 执行成功还是失败，只要脚本退出，就会自动执行清理操作，包括：
    *   卸载所有绑定挂载，恢复系统原始的只读目录。
    *   删除所有创建的临时文件和目录。
这个过程确保了安装可以顺利进行，同时又不会对原始系统造成任何永久性的破坏。
## 如何使用
1.  **放置文件**：将 `xiu.sh` 脚本和您需要运行的 `vtoyboot.sh` 脚本放在同一个目录下。
2.  **授予权限** (可选，但推荐):
    ```bash
    chmod +x xiu.sh
    ```
3.  **运行脚本**：必须使用 `root` 权限 ( `sudo` ) 来运行此修复脚本。
    ```bash
    sudo ./xiu.sh
    # 或者
    sudo bash xiu.sh
    ```
脚本会自动完成所有操作，包括执行 `vtoyboot.sh` 和后续的清理工作。 
